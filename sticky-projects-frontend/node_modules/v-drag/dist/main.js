/*!
 * v-drag v3.0.7
 * by Nil Vila and contributors
 */
"use strict";function a(a,t){const e="x"===t?window.data.snapX:window.data.snapY;return Math.round(a/e)*e}function t(a,t,e="add"){a.forEach(a=>{document[e+"EventListener"](a,t,!1)})}function e(a,t,e){return`matrix(${a||"1, 0, 0, 1,"} ${t}, ${e})`}function n(a,t){a.dispatchEvent(new Event("v-drag-"+t))}function o(t,o){window.data.relativeX=window.data.mouseX*t,window.data.relativeY=window.data.mouseY*o,window.data.move.style.transform=e(window.data.matrix,window.data.matrixX+a(window.data.relativeX,"x"),window.data.matrixY+a(window.data.relativeY,"y")),n(window.data.move,"moving"),(window.getSelection?window.getSelection():document.selection).empty()}const d={x(){o(!0,!1)},y(){o(!1,!0)},all(){o(!0,!0)}};function i(){d[window.data.axis](window.data),window.data.posAnimation=requestAnimationFrame(i)}function s(){window.data.move.classList.add(window.data.class.move),window.data.posAnimation=requestAnimationFrame(i),t(["mousemove","touchmove"],s,"remove")}function w(a,t){let e=Number(window.getComputedStyle(window.data.move)[t].replace("px",""));if("none"!==a){const n=a.match(/[0-9.-]+/g);e+=Number(n[8-t.length])}return e}function l(a,t,e){const n=["rect","circle","text","ellipse","image"],o=n.includes(window.data.move.nodeName)?"x":"left",d=n.includes(window.data.move.nodeName)?"y":"top";window.data.move.style.transform=a,window.data.move.style[o]=t,window.data.move.style[d]=e}function c(a){a.preventDefault(),window.data.mouseX=(a.pageX||a.touches[0].pageX)-window.data.initialX,window.data.mouseY=(a.pageY||a.touches[0].pageY)-window.data.initialY,window.setTimeout(()=>{(a.clientY||a.touches[0].clientY)>.8*window.innerHeight&&(document.documentElement.scrollTop+=10),(a.clientY||a.touches[0].clientY)<.2*window.innerHeight&&(document.documentElement.scrollTop-=10),(a.clientX||a.touches[0].clientX)>.8*window.innerWidth&&(document.documentElement.scrollLeft+=10),(a.clientX||a.touches[0].clientX)<.2*window.innerWidth&&(document.documentElement.scrollLeft-=10)},100)}function r(a,o,d,i,r){r.preventDefault(),window.data.grab=a,window.data.move=o,window.data.axis=d,window.data.initialX=r.pageX||r.touches[0].pageX,window.data.initialY=r.pageY||r.touches[0].pageY,window.data.relativeX=0,window.data.relativeY=0,window.data.snapX=i.x,window.data.snapY=i.y;const u=window.getComputedStyle(window.data.move).transform;window.data.matrix="none"!==u&&u.match(/\d([^,]*,){4}/g);const m=["rect","circle","text","ellipse","image","path"],v=m.includes(window.data.move.nodeName)?"x":"left",p=m.includes(window.data.move.nodeName)?"y":"top",h=w(u,v),g=w(u,p);l(e(window.data.matrix,h,g),0,0),window.data.matrixX=h,window.data.matrixY=g,window.data.grab.classList.add(window.data.class.down),n(o,"down"),t(["mousemove","touchmove"],c),t(["mousemove","touchmove"],s)}function u(){window.data.grab&&window.data.move&&(cancelAnimationFrame(window.data.posAnimation),t(["mousemove","touchmove"],s,"remove"),l(window.data.matrix?e(window.data.matrix,0,0):"none",window.data.matrixX+a(window.data.relativeX,"x")+"px",window.data.matrixY+a(window.data.relativeY,"y")+"px"),window.data.grab.classList.remove(window.data.class.down),window.data.move.classList.remove(window.data.class.move),n(window.data.move,"end"),t(["mousemove","touchmove"],c,"remove"))}function m(a,t){const e="string"==typeof a?parseInt(a.replace(/px/g,""),10):a;return 0===e||Number.isNaN(e)||t&&void 0===e?1:e}function v(a){return!!["x","y","all"].includes(a)}function p(a,e){const o=e.value||{},d=o instanceof Object?o.handle:o,i=function(a){if("string"==typeof a){const t=a.split(",");return{x:m(t[0]),y:void 0!==m(t[1])?m(t[1]):m(t[0])}}return"number"==typeof a?{x:m(a),y:m(a)}:a instanceof Object&&(a.x||a.y)?{x:m(a.x)||1,y:m(a.y)||1}:Array.isArray(a)?{x:m(a[0])||1,y:void 0!==m(a[1])?m(a[1],!0):m(a[0],!0)}:{x:1,y:1}}(o.snap),s=[];let w;w=o instanceof Object&&o.axis&&v(o.axis)?o.axis:v(e.arg)?e.arg:"all",d instanceof HTMLElement?s.push(d):document.querySelectorAll(d).forEach(a=>{s.push(a)}),0!==s.length?(a.classList.add(window.data.class.usesHandle),s.forEach(t=>{t.classList.add(window.data.class.handle),t.onmousedown=e=>r(t,a,w,i,e),t.ontouchstart=e=>r(t,a,w,i,e)})):(a.onmousedown=t=>r(a,a,w,i,t),a.ontouchstart=t=>r(a,a,w,i,t)),a.classList.add(window.data.class.initial),n(a,"setup"),t(["mouseup","touchend"],u)}const h=(a,t)=>{p(a,t)},g=(a,t)=>{a.onmousedown=null,a.ontouchstart=null;const e="object"==typeof t.oldValue?t.oldValue.handle:t.oldValue;document.querySelectorAll(e).forEach(t=>{t.onmousedown=null,t.ontouchstart=null,t.classList.remove(window.data.class.handle),a.classList.remove(window.data.class.usesHandle)}),t.oldValue&&Object.keys(t.oldValue).forEach(t=>{n(a,"update-"+t)}),p(a,t)};var f={install(a,t){window.data={},window.data.class={initial:"drag-draggable",usesHandle:"drag-uses-handle",handle:"drag-handle",down:"drag-down",move:"drag-move"};let e=!0;if(t){if(t.eventClass){const a=t.eventClass;Object.keys(a).forEach(t=>{a[t]&&(window.data.class[t]=a[t])})}"boolean"==typeof t.removeTransition&&(e=t.removeTransition)}const n=document.createElement("style");n.innerHTML=`.${window.data.class.initial}{position:relative;}.${window.data.class.initial}:not(.${window.data.class.usesHandle}),.${window.data.class.handle}{cursor:move;cursor:grab;cursor:-webkit-grab;}.${window.data.class.handle}.${window.data.class.down},.${window.data.class.initial}:not(.${window.data.class.usesHandle}).${window.data.class.down}{z-index:999;cursor:grabbing;cursor:-webkit-grabbing;}`,n.innerHTML+=!0===e?`.${window.data.class.move}{transition:none;}`:"",document.body.appendChild(n),a.directive("drag",{mounted(a,t){h(a,t)},updated(a,t){g(a,t)},inserted(a,t){h(a,t)},update(a,t){g(a,t)}})}};module.exports=f;
